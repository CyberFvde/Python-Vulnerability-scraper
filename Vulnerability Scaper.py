import requests
import csv

# List of vendor websites to retrieve vulnerability data from
vendor_websites = [
    "https://vendor1.com/vulnerabilities",
    "https://vendor2.com/vulnerabilities",
    # ...
    "https://vendor55.com/vulnerabilities"
]

# Dictionary to store the vulnerability data for each vendor website
vulnerability_data = {}

# Loop through each vendor website
for website in vendor_websites:
    # Make a GET request to the vendor website
    response = requests.get(website)

    # Check if the request was successful
    if response.status_code == 200:
        # Store the vulnerability data for this vendor website
        vulnerability_data[website] = response.json()
    else:
        # Log an error if the request was not successful
        print(f"Error retrieving data from {website}: {response.status_code}")

# Write the vulnerability data to a CSV file
with open("vulnerability_data.csv", "w", newline="") as file:
    writer = csv.writer(file)

    # Write the header row
    writer.writerow(["Vendor Website", "Vulnerability ID", "Description", "Severity"])

    # Loop through each vendor website
    for website, data in vulnerability_data.items():
        # Loop through each vulnerability for this vendor website
        for vulnerability in data["vulnerabilities"]:
            # Write a row for this vulnerability
            writer.writerow([
                website,
                vulnerability["id"],
                vulnerability["description"],
                vulnerability["severity"]
            ])
